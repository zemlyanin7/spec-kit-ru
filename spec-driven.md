# Разработка, управляемая спецификациями (Specification-Driven Development, SDD)

## Инверсия власти

Десятилетиями код считался главной ценностью. Спецификации служили коду: их писали, чтобы направить разработку, а потом забрасывали. Мы создавали PRD, проектные документы, схемы — все ради того, чтобы объяснить разработчикам, что нужно делать. Но истинным источником правды оставался код. Документация быстро устаревала, спецификации не успевали за реализацией. Пока актив (код) и его реализация сливались воедино, развивать альтернативные решения, не копаясь в коде, было почти невозможно.

SDD переворачивает эту иерархию. Теперь спецификации не обслуживают код — код обслуживает спецификации. PRD перестаёт быть «подсказкой» для разработчиков и становится исходником, из которого появляется реализация. Технический план — не документ «для сведения», а точное определение, по которому генерируется код. Это не эволюция старого процесса, а переосмысление того, что движет разработкой.

Исторически главное противоречие между спецификацией и реализацией мы пытались решить лучшей документацией, более строгими процессами, детализированными требованиями. Все эти подходы смирялись с существованием разрыва, стараясь лишь сузить его. SDD устраняет разрыв: спецификация и созданный на её основе план становятся исполнимыми артефактами. Когда они генерируют код, разрыв исчезает — остаётся только преобразование.

Такой подход стал возможен благодаря ИИ, который способен понимать сложные спецификации и строить подробные планы реализации. Но «сырой» ИИ без структуры порождает хаос. SDD даёт эту структуру: спецификации и планы должны быть настолько точными, полными и однозначными, чтобы на их основе можно было собрать рабочую систему. Спецификация превращается в первичный артефакт, а код — лишь её выражение на конкретном языке и в конкретном фреймворке.

В этой реальности сопровождение ПО — это развитие спецификаций. Намерения команды формулируются на естественном языке («разработка, управляемая намерениями»), в дизайн-материалах, принципах и руководствах. **Lingua franca** разработки поднимается на уровень выше, а код становится «последней милей», итоговым выражением.

Отладка означает корректировку спецификаций и планов, которые породили неверный код. Рефакторинг означает повышение ясности описаний. Весь цикл разработки перестраивается вокруг спецификаций как единого источника правды, а планы и код становятся постоянно регенерируемым результатом. Добавление функции или параллельной реализации — это возврат к спецификации и подготовка нового плана. Процесс становится последовательностью 0 → 1, (1′, …), 2, 3, N.

Так команда концентрируется на творчестве, экспериментах и критическом мышлении.

## Практика SDD

Процесс начинается с идеи — часто разрозненной и неполной. Через итеративный диалог с ИИ она превращается в развёрнутый PRD. ИИ задаёт уточняющие вопросы, выявляет крайние случаи, помогает сформулировать критерии приёмки. То, что в классической разработке занимает дни, укладывается в часы сосредоточенной работы над спецификацией. Традиционный SDLC трансформируется: требования и дизайн становятся непрерывной деятельностью, а не отдельными фазами. Это поддерживает **командный процесс** — спецификации пишутся и рецензируются в ветках, версионируются и сливаются.

Когда продакт-менеджер меняет критерии приёмки, план автоматически подсвечивает затронутые технические решения. Если архитектор предлагает более эффективный паттерн, PRD обновляется, чтобы отразить новые возможности.

Во время работы над спецификацией агенты-исследователи собирают важный контекст: совместимость библиотек, показатели производительности, ограничения по безопасности. Организационные требования (стандарты СУБД, политика аутентификации, регламенты деплоя) автоматически внедряются в каждую спецификацию.

На основе PRD ИИ формирует план реализации, сопоставляя требования с техническими решениями. Каждое технологическое решение документирует свою мотивацию. Каждое архитектурное решение связывается с конкретными требованиями. Весь процесс сопровождается непрерывной валидацией: ИИ ищет неоднозначности, противоречия и пробелы не один раз «на входе», а постоянно, помогая уточнять спецификацию.

Генерация кода начинается, когда спецификация и план достаточно стабильны — им необязательно быть «завершёнными». Первые итерации могут быть исследовательскими, чтобы проверить жизнеспособность подхода. Понятийная модель предметной области оказывается оформленной прежде, чем появляются таблицы базы данных или классы.

## Преобразование команды SDD

В традиционном SDLC продуктовые, проектные и архитектурные артефакты были статичными: информация фиксировалась, разработчики реализовывали. В SDD продуктовые и инженерные артефакты становятся живыми и синхронными. Асинхронные команды пишут спецификации параллельно, плавно добавляя детали:

> *«Я не понимаю, это мобильный сценарий? Можешь уточнить?»*

Или:

> *«Похоже, в разделе безопасности есть пропуск. Есть ли требования SOC 2?»*

AI-помощники подключаются к процессу на всех этапах: уточняют требования, дополняют контекст, обогащают план.

### Источники правды

SDD вводит несколько ключевых артефактов:

1. **Конституция** — набор принятых принципов.
2. **Спецификация** (PRD) — подробное описание функционала, UX, ограничений и сценариев.
3. **План реализации** — техническая карта, связывающая требования и решения.
4. **Разбиение на задачи** — последовательность действий для реализации плана.
5. **Исследования** — отчёты о сторонних библиотеках, ограничениях, паттернах.

Каждый шаг поддерживается шаблонами и рабочими процессами, чтобы поддерживать единый стиль работы.

## Архитектура процесса

SDD — это не только набор шагов, но и чёткая иерархия артефактов:

```
Конституция (принципы)
   ↓
Спецификация (PRD)
   ↓
План реализации
   ↓
Разбиение на задачи
   ↓
Код / Тесты
```

Любые изменения делаются сверху вниз. Если мы добавляем новую функцию, сначала обновляется спецификация, затем план, затем задачи, и только потом — код. Это обеспечивает строгую синхронизацию намерений и реализации.

## Инструменты и артефакты

### 1. Конституция

Конституция — главный документ проекта. Он описывает принципы:

- архитектурные правила,
- стандарты тестирования,
- требования к простоте,
- подходы к интеграционному тестированию,
- процесс внесения изменений и т.д.

Конституция — живой документ, но с чёткой процедурой изменения: любые поправки должны быть обоснованы, одобрены и снабжены планом миграции.

### 2. Генерация спецификации

Процесс создания спецификации происходит в несколько этапов:

1. **Первичная спецификация**: определение пользовательских сценариев, ключевых ролей, ограничений, критериев приёмки.
2. **Уточнение**: ответы на вопросы ИИ, устранение пробелов, добавление диаграмм, макетов.
3. **Сверка с чек-листом**: подтверждение, что спецификация покрывает все обязательные пункты (данные, UX, производительность, безопасность и т.п.).

Результат — подробная спецификация с чётким scope, которая становится единственным источником правды.

### 3. План реализации

План связывает требования и технические решения:

- архитектура и модули;
- выбранные фреймворки и их обоснование;
- подходы к данным, интеграциям, инфраструктуре;
- стратегия тестов (unit, contract, e2e);
- этапы внедрения.

План проходит «ворота» (gates) перед реализацией: проверяется простота, отсутствие лишних абстракций, готовность к интеграционным тестам. Любое отклонение фиксируется с обоснованием.

### 4. Разбиение на задачи

`/specify-ru.tasks` создаёт `tasks.md`:

- задачи группируются по юзерстори;
- указываются зависимости и потенциальные параллельные задачи;
- прописываются пути к файлам;
- если требуется TDD, тесты идут перед реализацией;
- добавляются контрольные точки (checkpoints).

### 5. Реализация

`/specify-ru.implement` исполняет задачи:

- проверяет наличие всех обязательных файлов (конституция, спецификация, план, tasks);
- выполняет задачи в нужной последовательности;
- соблюдает TDD и отмечает прогресс;
- собирает отчёт об успехах и ошибках.

## Трансформация роли команды

SDD не заменяет разработчиков и не автоматизирует творчество. Он освобождает время для важного: проектирования, проверки гипотез, взаимодействия со стейкхолдерами. Механический перевод текстов в код автоматизируется, а команда фокусируется на осмысленном построении продукта.

## Преимущества SDD

1. **Единый источник правды** — можно восстановить контекст решения, не анализируя историю коммитов.
2. **Предсказуемость** — план и задачи определяют путь к релизу.
3. **Повторяемость** — одинаковый подход для разных команд и проектов.
4. **Масштабируемость** — легко добавлять новые команды и агентов.
5. **Прозрачность** — легко объяснить, почему принято то или иное решение.

## Изменение культуры

Переход на SDD меняет культуру:

- **Планирование вместо импровизации**: внедряется привычка фиксировать решения заранее.
- **Прозрачность**: каждый шаг задокументирован, любой участник команды знает, что происходит.
- **Критическое мышление**: ИИ выступает как оппонент, который задаёт неудобные вопросы.
- **Совместная работа**: спеки, планы и задачи проходят ревью и обсуждение.

## Заключение

SDD — это не просто про генерацию кода с помощью ИИ. Это новая модель, где спецификации и планы становятся исполнимыми, а код — результатом строгого процесса. Мы избавляемся от разрыва между намерением и реализацией, создавая тесный цикл обратной связи, где спецификация, исследования и код развиваются вместе.

Разработке нужны инструменты, которые поддерживают соответствие между замыслом и результатом. SDD предлагает методологию, которая делает спецификации первичными, а код — их производной. Это путь к устойчивой архитектуре, прозрачным решениям и высокой скорости, не жертвуя качеством.
