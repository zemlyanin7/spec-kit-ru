---
description: Создать или обновить конституцию проекта на основе введённых принципов и синхронизировать связанные шаблоны.
---

## Ввод пользователя

```text
$ARGUMENTS
```

Вы **ОБЯЗАНЫ** учитывать ввод пользователя перед продолжением (если он не пустой).

## Общий план

Вы работаете с конституцией по адресу `/memory/constitution.md`. Это шаблон с плейсхолдерами в квадратных скобках (`[PROJECT_NAME]`, `[PRINCIPLE_1_NAME]` и т.д.). Нужно: (a) собрать конкретные значения, (b) аккуратно заполнить шаблон, (c) при необходимости синхронизировать зависимые артефакты.

1. Загрузите текущий шаблон `/memory/constitution.md`.
   - Определите все плейсхолдеры `[ALL_CAPS_IDENTIFIER]`.
   - Если пользователь говорит про другое число принципов — адаптируйте документ соответствующим образом.

2. Соберите значения для плейсхолдеров:
   - Используйте данные из диалога, если они есть.
   - Иначе — извлекайте из контекста репозитория (README, docs, предыдущие версии).
   - Даты:
     * `RATIFICATION_DATE` — первоначальная дата принятия (при отсутствии спросите или поставьте TODO).
     * `LAST_AMENDED_DATE` — сегодняшняя дата, если есть изменения; иначе оставьте прежнюю.
   - Версия `CONSTITUTION_VERSION` повышается по правилам semver:
     * MAJOR — несовместимые изменения принципов.
     * MINOR — добавление принципа/раздела или существенное расширение.
     * PATCH — уточнения без изменения смысла.
   - Если тип повышения версии неочевиден — поясните выбор.

3. Составьте обновлённую конституцию:
   - Замените все плейсхолдеры конкретными значениями (не оставляйте квадратных скобок, кроме тех, чьё заполнение сознательно отложено и обосновано).
   - Сохраните структуру заголовков.
   - Каждый принцип: краткое имя, набор обязательных правил, при необходимости — мотивация.
   - Раздел «Governance» должен описывать процедуру изменений, версионирование и проверку соблюдения.

4. Проверьте соответствие связанных шаблонов:
   - `templates/plan-template.md` — раздел «Constitution Check» должен отражать актуальные принципы.
   - `templates/spec-template.md` — убедитесь, что обязательные разделы/ограничения согласованы.
   - `templates/tasks-template.md` — проверьте, что задачи учитывают обновлённые принципы (наблюдаемость, тестирование и т.п.).
   - Все файлы в `templates/commands/` — обновите ссылки на принципы, если они изменились.
   - Основные руководства (`README.md`, `docs/quickstart.md` и т.д.) — при необходимости обновите упоминания принципов.

5. Сформируйте **Sync Impact Report** (HTML-комментарий в начале файла после обновления):
   - Изменение версии (старая → новая).
   - Список изменённых принципов (старое название → новое, если переименованы).
   - Добавленные/удалённые разделы.
   - Шаблоны, требующие синхронизации ( ✅ обновлено / ⚠ требует действия ) с путями.
   - TODO, если какие-то плейсхолдеры оставлены с пометкой.

6. Перед сохранением убедитесь:
   - Нет необъяснённых плейсхолдеров.
   - Версия в тексте соответствует отчёту.
   - Даты в формате YYYY-MM-DD.
   - Формулировки принципов конкретные (избегать «должен», «желательно»; используйте MUST/SHOULD с пояснениями).

7. Сохраните обновлённую конституцию (перезапишите `/memory/constitution.md`).

8. Сообщите пользователю:
   - Новую версию и обоснование повышения.
   - Файлы, требующие ручной доработки (если есть).
   - Рекомендованный commit message (например, `docs: update constitution to vX.Y.Z with new principles`).

### Требования к оформлению

- Оставляйте оригинальные уровни заголовков.
- Между разделами — по одной пустой строке.
- Удаляйте лишние комментарии после заполнения.
- Не добавляйте лишние пробелы в конце строк.

Если пользователь меняет только часть документа — всё равно выполните проверки и определите, нужно ли повышать версию.

Если критических данных нет (например, дата неизвестна) — оставьте `TODO(CONCEPT): пояснение` и укажите это в Sync Impact Report.

Новый шаблон создавать не нужно — работайте только с `/memory/constitution.md`.
